generator client {
  provider        = "prisma-client-js"
  // clientExtensions causing error
  // previewFeatures = ["fieldReference", "postgresqlExtensions", "filteredRelationCount", "multiSchema", "clientExtensions"]
  previewFeatures = ["fieldReference", "postgresqlExtensions", "filteredRelationCount"]

  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

// generator docs {
//   provider = "node node_modules/prisma-docs-generator"
//   output   = "../../../docs/database"
//}

generator zod {
  provider      = "zod-prisma"
  output        = "../zod-schemas"
  imports       = "../zod-util"
  relationModel = "default"
}

generator dbml {
  provider              = "prisma-dbml-generator"
  output                = "./dbml"
  outputName            = "inreach.dbml"
  projectName           = "InReach"
  projectDatabaseType   = "PostgreSQL"
  includeRelationFields = false
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [postgis]
  // schemas    = ["user", "org", "system"]
}

/// NextAuth Account **DO NOT ALTER**
model Account {
  id                String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  user   User   @relation("Account", fields: [userId], references: [id], onDelete: Cascade)
  userId String /// @zod.custom(imports.cuid)

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  auditLog  AuditLog[]

  @@unique([provider, providerAccountId])
}

/// NextAuth Session **DO NOT ALTER**
model Session {
  // Do not change - NextAuth fields
  id           String   @id @default(cuid()) /// @zod.custom(imports.cuid)
  sessionToken String   @unique
  expires      DateTime

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String /// @zod.custom(imports.cuid)
}

/// NextAuth Verification Token **DO NOT ALTER**
model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

/// NextAuth User
model User {
  //
  // Do not change - NextAuth fields
  //
  id            String    @id @default(cuid()) /// @zod.custom(imports.cuid)
  name          String?
  email         String    @unique(sort: Asc)
  emailVerified DateTime?
  image         String?
  accounts      Account[] @relation("Account")
  sessions      Session[]
  //
  // Ok to change below - Start of custom fields
  //
  legacyId      String?   @unique /// old ID from MongoDB

  active          Boolean           @default(true)
  permissions     PermissionItem[]
  /// assets that certain permissible roles are attributed to (edit org, etc)
  PermissionAsset PermissionAsset[]

  // Current location
  currentCity      String?
  currentGovDist   GovDist? @relation(fields: [currentGovDistId], references: [id])
  currentGovDistId String? /// @zod.custom(imports.cuid)
  currentCountry   Country? @relation(name: "currentCountry", fields: [currentCountryId], references: [id])
  currentCountryId String? /// @zod.custom(imports.cuid)

  // Data for AWS Cognito migration
  //  migrated from old DB - once user is migrated to Cognito, legacy fields are cleared, migrateDate is set
  legacyHash  String?
  legacySalt  String?
  migrateDate DateTime?

  // for LCR accounts
  communities     UserCommunity[] /// used for LCR accounts ONLY
  userSOGIdentity UserSOGIdentity[] /// used for LCR accounts ONLY

  // Relationships
  savedLists          UserSavedList[] @relation("savedLists")
  listsSharedWithUser UserSavedList[] @relation("listsSharedWithUser")

  role   UserRole @relation(fields: [roleId], references: [id])
  roleId String /// @zod.custom(imports.cuid)

  userType   UserType @relation(fields: [userTypeId], references: [id])
  userTypeId String /// @zod.custom(imports.cuid)

  langPref   Language? @relation(fields: [langPrefId], references: [id])
  langPrefId String? /// @zod.custom(imports.cuid)

  source   Source? @relation(name: "userSource", fields: [sourceId], references: [id])
  sourceId String? /// @zod.custom(imports.cuid)

  mailReceived UserMail[] @relation("mailTo")
  mailSent     UserMail[] @relation("mailFrom")

  // For claimed organizations / organization staff
  associatedOrg   Organization? @relation(fields: [associatedOrgId], references: [id])
  associatedOrgId String? /// @zod.custom(imports.cuid)
  orgTitle        UserTitle?    @relation(fields: [orgTitleId], references: [id])
  orgTitleId      String? /// @zod.custom(imports.cuid)
  orgEmail        OrgEmail?     @relation("associatedEmail")
  orgPhone        OrgPhone?     @relation("associatedPhone")

  FieldVisibility FieldVisibility[] /// For user profile page. All fields default to 'NONE'

  /// Recording changes made by user
  AuditLogEntry AuditLog[] @relation("Recorded User")

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  auditLog  AuditLog[] @relation("AuditLogEntry")
}

/// User Role - Contains array of granular permissions
///  Internal use
model UserRole {
  id   String @id @default(cuid()) /// @zod.custom(imports.cuid)
  name String @unique
  tag  String @unique

  permissions PermissionItem[]
  user        User[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// For permissions that are attached to certain records
///  example: User is only able to edit one organization.
model PermissionAsset {
  id     String @id @default(cuid()) /// @zod.custom(imports.cuid)
  user   User   @relation(fields: [userId], references: [id])
  userId String /// @zod.custom(imports.cuid)

  permission   PermissionItem @relation(fields: [permissionId], references: [id])
  permissionId String /// @zod.custom(imports.cuid)

  organization Organization[]
  location     OrgLocation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// Permission Definition
model PermissionItem {
  id   String @id @default(cuid()) /// @zod.custom(imports.cuid)
  name String @unique

  users  User[]
  roles  UserRole[]
  assets PermissionAsset[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// User Info - account type (seeker, org, lawyer, etc.)
///  use shorthand descriptions - front-end displayable text is defined in Translations
model UserType {
  id    String @id @default(cuid()) /// @zod.custom(imports.cuid)
  type  String @unique
  users User[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// User Info - professional title
///  this will be a searchable list
model UserTitle {
  id         String     @id @default(cuid()) /// @zod.custom(imports.cuid)
  title      String     @unique
  email      OrgEmail[]
  orgUser    User[]
  searchable Boolean    @default(false)

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

model UserSurvey {
  id String @id @default(cuid()) /// @zod.custom(imports.cuid)

  birthYear     Int?    @db.SmallInt
  reasonForJoin String?

  communities     UserCommunity[]
  ethnicity       UserEthnicity[]
  identifiesAs    UserSOGIdentity[]
  countryOrigin   Country?          @relation(fields: [countryOriginId], references: [id])
  countryOriginId String? /// @zod.custom(imports.cuid)
  immigration     UserImmigration?  @relation(fields: [immigrationId], references: [id])
  immigrationId   String? /// @zod.custom(imports.cuid)
}

/// User demographics - Ethnicity
model UserEthnicity {
  id        String       @id @default(cuid()) /// @zod.custom(imports.cuid)
  ///  use shorthand descriptions - front-end displayable text is defined in Translations
  ethnicity String       @unique
  surveys   UserSurvey[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// User demographics - Immigration Status
model UserImmigration {
  id      String       @id @default(cuid()) /// @zod.custom(imports.cuid)
  ///  use shorthand descriptions - front-end displayable text is defined in Translations
  status  String       @unique
  surveys UserSurvey[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// User demographics - Sexual orientation / Identity
model UserSOGIdentity {
  id         String       @id @default(cuid()) /// @zod.custom(imports.cuid)
  ///  use shorthand descriptions - front-end displayable text is defined in Translations
  identifyAs String       @unique
  surveys    UserSurvey[]
  users      User[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

/// User demographics - Community
model UserCommunity {
  id        String @id @default(cuid()) /// @zod.custom(imports.cuid)
  ///  use shorthand descriptions - front-end displayable text is defined in Translations
  community String @unique
  users     User[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog     AuditLog[]
  UserSurvey   UserSurvey? @relation(fields: [userSurveyId], references: [id])
  userSurveyId String?
}

/// User's list(s) of saved resources.
model UserSavedList {
  id            String                  @id @default(cuid()) /// @zod.custom(imports.cuid)
  name          String
  organizations Organization[]
  visibility    UserSavedListVisibility @default(PRIVATE)
  sharedWith    User[]                  @relation("listsSharedWithUser")
  /// Generated string to share a list via link
  sharedLinkKey String?                 @unique

  ownedBy   User   @relation("savedLists", fields: [ownedById], references: [id])
  ownedById String /// @zod.custom(imports.cuid)

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  auditLog  AuditLog[]

  @@index([ownedById])
}

/// List visiblity
enum UserSavedListVisibility {
  PRIVATE
  SHARED_USER
  SHARED_LINK
  PUBLIC
}

model UserMail {
  id         String   @id @default(cuid()) /// @zod.custom(imports.cuid)
  toUser     User     @relation("mailTo", fields: [toUserId], references: [id])
  toUserId   String /// @zod.custom(imports.cuid)
  toExternal String[] /// Array of email addresses
  read       Boolean  @default(false)
  subject    String
  body       String

  from       String?
  fromUser   User?   @relation("mailFrom", fields: [fromUserId], references: [id])
  fromUserId String? /// @zod.custom(imports.cuid)

  replies UserMail[] @relation("userMailReplies")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog     AuditLog[]
  responseTo   UserMail?  @relation("userMailReplies", fields: [responseToId], references: [id])
  responseToId String?
}

/// Main organization definition
model Organization {
  id        String          @id @default(cuid()) /// @zod.custom(imports.cuid)
  legacyId  String?         @unique /// old ID from MongoDB
  name      String
  slug      String          @unique /// @zod.regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/gm)
  // i18n description key
  descKey   TranslationKey? @relation(fields: [descKeyId], references: [id])
  descKeyId String?

  email               OrgEmail[]
  location            OrgLocation[]
  notes               InternalNote[]
  phone               OrgPhone[]
  photos              OrgPhoto[]
  services            OrgService[]
  orgSocialMedia      OrgSocialMedia[]
  orgWebsite          OrgWebsite[]
  userList            UserSavedList[]
  reviews             OrgReview[]
  attributes          Attribute[]
  attributeSupplement AttributeSupplement[]
  serviceArea         ServiceArea?
  hours               OrgHours[] // for schedules that need to be assigned to locations

  deleted      Boolean   @default(false)
  published    Boolean   @default(false)
  lastVerified DateTime?

  // Users associated with organization (staff)
  associatedUsers User[]
  allowedEditors  PermissionAsset[]

  // Outside API connections
  outsideApi    OutsideAPI? @relation(fields: [outsideApiId], references: [id])
  outsideApiId  String? /// @zod.custom(imports.cuid)
  apiIdentifier String?

  source   Source @relation(fields: [sourceId], references: [id])
  sourceId String /// @zod.custom(imports.cuid)

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  auditLog  AuditLog[]

  /// Does this record need to be checked by staff after migration?
  checkMigration Boolean?

  @@index([name(sort: Asc)])
}

/// Organization email contacts - can be general or location specific
model OrgEmail {
  id         String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  legacyId   String? @unique /// old ID from MongoDB
  legacyDesc String?
  firstName  String?
  lastName   String?
  primary    Boolean @default(false)
  email      String
  published  Boolean @default(true)
  deleted    Boolean @default(false)

  title   UserTitle? @relation(fields: [titleId], references: [id])
  titleId String? /// @zod.custom(imports.cuid)

  organization Organization? @relation(fields: [orgId], references: [id])
  orgId        String? /// @zod.custom(imports.cuid)

  user   User?   @relation(name: "associatedEmail", fields: [userId], references: [id])
  userId String? @unique /// @zod.custom(imports.cuid)

  // optional - attach email to a specific location/service
  orgLocation     OrgLocation? @relation(fields: [orgLocationId], references: [id])
  orgLocationId   String? /// @zod.custom(imports.cuid)
  orgService      OrgService?  @relation(fields: [orgServiceId], references: [id])
  orgServiceId    String? /// @zod.custom(imports.cuid)
  /// associated only with location/service and not overall organization (for large orgs w/ multiple locations)
  orgLocationOnly Boolean      @default(false)
  orgServiceOnly  Boolean      @default(false)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@index([lastName(sort: Asc), firstName])
  @@index([email])
}

/// Org phone numbers - can be general or location specific
model OrgPhone {
  id         String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  legacyId   String? @unique /// old ID from MongoDB
  legacyDesc String?
  number     String
  ext        String?
  primary    Boolean @default(false)
  published  Boolean @default(true)
  deleted    Boolean @default(false)

  /// Country profiles have intl dial prefix
  country   Country @relation(fields: [countryId], references: [id])
  countryId String /// @zod.custom(imports.cuid)

  phoneType   PhoneType? @relation(fields: [phoneTypeId], references: [id])
  phoneTypeId String? /// @zod.custom(imports.cuid)

  organization   Organization? @relation(fields: [organizationId], references: [id])
  organizationId String? /// @zod.custom(imports.cuid)

  user   User?   @relation(name: "associatedPhone", fields: [userId], references: [id])
  userId String? @unique /// @zod.custom(imports.cuid)

  /// associated only with location and not overall organization (for large orgs w/ multiple locations)
  orgLocationOnly Boolean       @default(false)
  orgLocation     OrgLocation[]

  orgService OrgService[]

  phoneLang Language[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Organization's social media links
model OrgSocialMedia {
  id        String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  username  String
  url       String
  deleted   Boolean @default(false)
  published Boolean @default(true)

  service   SocialMediaService @relation(fields: [serviceId], references: [id])
  serviceId String /// @zod.custom(imports.cuid)

  organization   Organization @relation(fields: [organizationId], references: [id])
  organizationId String /// @zod.custom(imports.cuid)

  orgLocation     OrgLocation? @relation(fields: [orgLocationId], references: [id])
  orgLocationId   String?
  /// associated only with location and not overall organization (for large orgs w/ multiple locations)
  orgLocationOnly Boolean      @default(false)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

model OrgWebsite {
  id        String          @id @default(cuid()) /// @zod.custom(imports.cuid)
  url       String
  descKey   TranslationKey? @relation(fields: [descKeyId], references: [id])
  descKeyId String?

  organization   Organization @relation(fields: [organizationId], references: [id])
  organizationId String

  orgLocation     OrgLocation? @relation(fields: [orgLocationId], references: [id])
  orgLocationId   String?
  orgLocationOnly Boolean      @default(false)

  language   Language? @relation(fields: [languageId], references: [id])
  languageId String?

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Org location information
model OrgLocation {
  id       String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  legacyId String? @unique /// old ID from MongoDB
  name     String?
  street1  String
  street2  String?
  city     String
  postCode String?
  primary  Boolean @default(true)

  govDist   GovDist? @relation(fields: [govDistId], references: [id])
  govDistId String? /// @zod.custom(imports.cuid)

  country   Country @relation(fields: [countryId], references: [id])
  countryId String /// @zod.custom(imports.cuid)

  longitude Decimal? @db.Decimal(4, 3)
  latitude  Decimal? @db.Decimal(4, 3)
  geoJSON   Json /// @zod.custom(imports.GeoJSONSchema)

  published           Boolean               @default(true)
  deleted             Boolean               @default(false)
  hours               OrgHours[]
  attributes          Attribute[]
  attributeSupplement AttributeSupplement[]

  organization   Organization      @relation(fields: [orgId], references: [id])
  orgId          String            @unique /// @zod.custom(imports.cuid)
  allowedEditors PermissionAsset[]

  email       OrgEmail[] /// if location specific
  orgWebsite  OrgWebsite[] /// if location specific
  phone       OrgPhone[] /// if location specific
  photos      OrgPhoto[]
  services    OrgService[]
  serviceArea ServiceArea?
  socialMedia OrgSocialMedia[] /// if location specific

  // Outside API connections
  outsideApi    OutsideAPI? @relation(fields: [outsideApiId], references: [id])
  outsideApiId  String? /// @zod.custom(imports.cuid)
  apiLocationId String?

  reviews OrgReview[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  /// Does this record need to be checked by staff after migration?
  checkMigration Boolean?

  @@index([latitude, longitude])
  @@index([geoJSON(ops: JsonbPathOps)], type: Gin)
}

/// Organization photos
model OrgPhoto {
  id        String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  src       String
  height    Int?    @db.SmallInt
  width     Int?    @db.SmallInt
  published Boolean @default(false)
  deleted   Boolean @default(false)

  organization Organization? @relation(fields: [orgId], references: [id])
  orgId        String? /// @zod.custom(imports.cuid)

  orgLocation   OrgLocation? @relation(fields: [orgLocationId], references: [id])
  orgLocationId String? /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Organization location/service hours
///  day is stored as integer [0-6], Sunday = 0
///  start/end times are stored as RFC 3339 Timestamp (without zone)
///  as local time. Any timezone offset will be handled by runtime logic
model OrgHours {
  id       String   @id @default(cuid()) /// @zod.custom(imports.cuid)
  /// Sun 0, Mon 1, Tue 2, Wed 3, Thu 3, Fri 4, Sat 6
  dayIndex Int      @default(0) @db.SmallInt
  start    DateTime @db.Time(0)
  end      DateTime @db.Time(0)
  closed   Boolean  @default(false)

  orgLocation OrgLocation? @relation(fields: [orgLocId], references: [id])
  orgLocId    String? /// @zod.custom(imports.cuid)

  orgService   OrgService? @relation(fields: [orgServiceId], references: [id])
  orgServiceId String? /// @zod.custom(imports.cuid)

  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  auditLog       AuditLog[]
  internalNote   InternalNote[]
  organization   Organization?  @relation(fields: [organizationId], references: [id])
  organizationId String?
  needAssignment Boolean        @default(false)
  needReview     Boolean        @default(false)
  legacyId       String?
  legacyName     String?
  legacyNote     String?
  legacyStart    String?
  legacyEnd      String?
  legacyTz       String?
}

/// Organization's offered services - access instructions & details
///  associated with service tag
model OrgService {
  id        String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  legacyId  String? @unique /// old ID from MongoDB
  published Boolean @default(false)
  deleted   Boolean @default(false)

  service     ServiceTag[]
  serviceArea ServiceArea?

  hours     OrgHours[]
  orgReview OrgReview[]

  attributes          Attribute[]
  attributeSupplement AttributeSupplement[]

  organization   Organization? @relation(fields: [organizationId], references: [id])
  organizationId String? /// @zod.custom(imports.cuid)

  orgLocation OrgLocation[]
  orgPhone    OrgPhone[]
  orgEmail    OrgEmail[]

  accessKey   TranslationKey? @relation("Service Access Instructions", fields: [accessKeyId], references: [id])
  accessKeyId String?         @unique /// @zod.custom(imports.cuid)
  descKey     TranslationKey? @relation("Service Description", fields: [descKeyId], references: [id])
  descKeyId   String?         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  /// Does this record need to be checked by staff after migration?
  checkMigration Boolean?

  @@index([organizationId(sort: Asc)])
}

/// User reviews/ratings of organization
model OrgReview {
  id         String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  rating     Int     @db.SmallInt
  reviewText String?
  visible    Boolean @default(true)
  deleted    Boolean @default(false)

  organization   Organization @relation(fields: [organizationId], references: [id])
  organizationId String /// @zod.custom(imports.cuid)

  // Optional: Review can be attached to a specific service.
  orgService   OrgService? @relation(fields: [orgServiceId], references: [id])
  orgServiceId String? /// @zod.custom(imports.cuid)

  // Optional: Review can be attached to a specific service.
  orgLocation   OrgLocation? @relation(fields: [orgLocationId], references: [id])
  orgLocationId String? /// @zod.custom(imports.cuid)

  // Store the language of the review text
  // Use session locale value or Google Translate lang detect API
  // Optional: do not store anything if 'comment' is null
  language       Language? @relation(fields: [langId], references: [id])
  langId         String? /// @zod.custom(imports.cuid)
  /// How confident is the API guess?
  langConfidence Float?

  /// From https://perspectiveapi.com/
  toxicity Float?

  // Snapshot local community reviwer geographical info
  //  review should keep original geo data if LCR user updates their location.
  // Optional - only applicable if user is LCR
  lcrCity      String?
  lcrGovDist   GovDist? @relation(fields: [lcrGovDistId], references: [id])
  lcrGovDistId String? /// @zod.custom(imports.cuid)
  lcrCountry   Country? @relation(fields: [lcrCountryId], references: [id])
  lcrCountryId String? /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@index([organizationId(sort: Asc)])
  @@index([orgServiceId(sort: Asc)])
}

/// Additional Properties for Org/Service.
model AttributeCategory {
  id      String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  tag     String  @unique
  name    String  @unique
  icon    String?
  /// Internal description
  intDesc String?
  active  Boolean @default(true)

  namespace   TranslationNamespace @relation(fields: [namespaceId], references: [id])
  namespaceId String /// @zod.custom(imports.cuid)

  attribute Attribute[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

model Attribute {
  id      String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  tag     String  @unique
  name    String  @unique
  icon    String?
  /// Internal description
  intDesc String?
  active  Boolean @default(true)

  category AttributeCategory[]

  key   TranslationKey? @relation(fields: [keyId], references: [id])
  keyId String?         @unique /// @zod.custom(imports.cuid)

  requireText     Boolean @default(false)
  requireLanguage Boolean @default(false)
  requireCountry  Boolean @default(false)
  requireBoolean  Boolean @default(false)
  requireData     Boolean @default(false)

  defaultSupplement AttributeSupplement[]

  /// Tables using Attribute
  organization    Organization[]
  orgLocation     OrgLocation[]
  orgService      OrgService[]
  serviceCategory ServiceCategory[]
  serviceTag      ServiceTag[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

model AttributeSupplement {
  id     String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  active Boolean @default(true)

  data    Json? /// @zod.custom(imports.AttributeSupplement)
  boolean Boolean?

  textKey   TranslationKey? @relation(fields: [textKeyId], references: [id])
  textKeyId String?

  country   Country? @relation(fields: [countryId], references: [id])
  countryId String?

  language   Language? @relation(fields: [languageId], references: [id])
  languageId String?

  attributeDefault   Attribute? @relation(fields: [attributeDefaultId], references: [id])
  attributeDefaultId String?

  organization      Organization?    @relation(fields: [organizationId], references: [id])
  organizationId    String? /// @zod.custom(imports.cuid)
  service           OrgService?      @relation(fields: [serviceId], references: [id])
  serviceId         String? /// @zod.custom(imports.cuid)
  location          OrgLocation?     @relation(fields: [locationId], references: [id])
  locationId        String? /// @zod.custom(imports.cuid)
  serviceTag        ServiceTag?      @relation(fields: [serviceTagId], references: [id])
  serviceTagId      String? /// @zod.custom(imports.cuid)
  serviceCategory   ServiceCategory? @relation(fields: [serviceCategoryId], references: [id])
  serviceCategoryId String? /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

model ServiceCategory {
  id                          String                @id @default(cuid()) /// @zod.custom(imports.cuid)
  category                    String                @unique
  active                      Boolean               @default(true)
  services                    ServiceTag[]
  defaultAttributes           Attribute[]
  defaultAttributeSupplements AttributeSupplement[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

model ServiceTag {
  id                          String                @id @default(cuid()) /// @zod.custom(imports.cuid)
  name                        String
  active                      Boolean               @default(true)
  defaultAttributes           Attribute[]
  defaultAttributeSupplements AttributeSupplement[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  category   ServiceCategory @relation(fields: [categoryId], references: [id])
  categoryId String /// @zod.custom(imports.cuid)

  /// Tables referencing ServiceTag
  orgServices OrgService[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@unique([name, categoryId])
}

model ServiceArea {
  id     String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  active Boolean @default(true)

  isNational Boolean   @default(false)
  country    Country[]
  areas      GovDist[]

  organization   Organization? @relation(fields: [organizationId], references: [id])
  organizationId String?       @unique /// @zod.custom(imports.cuid)
  orgLocation    OrgLocation?  @relation(fields: [orgLocationId], references: [id])
  orgLocationId  String?       @unique /// @zod.custom(imports.cuid)
  orgService     OrgService?   @relation(fields: [orgServiceId], references: [id])
  orgServiceId   String?       @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Phone number descriptors
model PhoneType {
  id       String     @id @default(cuid()) /// @zod.custom(imports.cuid)
  type     String     @unique
  orgPhone OrgPhone[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Social media service properties
model SocialMediaService {
  id       String @id @default(cuid()) /// @zod.custom(imports.cuid)
  name     String @unique
  urlBase  String
  logoIcon String

  orgSocialMedia  OrgSocialMedia[]
  socialMediaLink SocialMediaLink[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Source of organization/user
///  *INTERNAL* - for tracking purposes
model Source {
  id     String     @id @default(cuid()) /// @zod.custom(imports.cuid)
  source String     @unique
  type   SourceType

  organization Organization[]
  user         User[]         @relation("userSource")

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

enum SourceType {
  EXTERNAL
  ORGANIZATION
  SYSTEM
  USER
}

/// Country metadata
model Country {
  id       String @id @default(cuid()) /// @zod.custom(imports.cuid)
  /// ISO 3166-1 alpha-2 Country code
  cca2     String @unique @db.Char(2)
  /// ISO 3166-1 alpha-3 Country code
  cca3     String @unique @db.Char(3)
  /// Country name (English).
  name     String @unique(sort: Asc)
  /// International dialing code
  dialCode Int?   @db.SmallInt
  /// Country flag (emoji)
  flag     String
  /// GeoJSON object - required only if this will be considered a "service area"
  geoJSON  Json? /// @zod.custom(imports.GeoJSONSchema)

  key   TranslationKey @relation("country", fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  demonym   TranslationKey? @relation("demonym", fields: [demonymId], references: [id])
  demonymId String?         @unique /// @zod.custom(imports.cuid)

  // List of administrative subdivisions
  govDist GovDist[]

  /// Tables using Country
  attributeSupplement AttributeSupplement[]
  orgAddress          OrgLocation[]
  orgReviews          OrgReview[]
  orgPhone            OrgPhone[]
  serviceArea         ServiceArea[]

  surveys      UserSurvey[]
  currentUsers User[]       @relation("currentCountry")

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Administrative districts for countries
model GovDist {
  id      String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  /// Name (English/Roman alphabet)
  name    String
  /// Slug - [country (ISO)]-[govdist]-[...]
  slug    String  @unique
  /// ISO-3166-2 code
  iso     String?
  /// Abbreviation (Optional)
  abbrev  String?
  /// GeoJSON object - required only if this will be considered a "service area"
  geoJSON Json? /// @zod.custom(imports.GeoJSONSchema)

  country   Country @relation(fields: [countryId], references: [id])
  countryId String /// @zod.custom(imports.cuid)

  govDistType   GovDistType @relation(fields: [govDistTypeId], references: [id])
  govDistTypeId String /// @zod.custom(imports.cuid)

  /// table can be used for "sub districts" (State -> County -> City)
  isPrimary    Boolean?  @default(true)
  parent       GovDist?  @relation(name: "associatedDistricts", fields: [parentId], references: [id])
  parentId     String? /// @zod.custom(imports.cuid)
  subDistricts GovDist[] @relation("associatedDistricts")

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  /// Tables using GovDist
  orgLocation OrgLocation[]
  orgReview   OrgReview[]
  user        User[]
  serviceArea ServiceArea[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@index([countryId])
  @@index([parentId])
}

/// Descriptor of principal administrative districts (state, province, county, etc.)
model GovDistType {
  id   String @id @default(cuid()) /// @zod.custom(imports.cuid)
  name String @unique

  govDist GovDist[]

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Languages - ETF BCP 47 language tag
///  top level & regional locale (ex: 'en', "en-us", "en-ca")
model Language {
  id                 String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  languageName       String
  /// ETF BCP 47 language tag
  localeCode         String  @unique(sort: Asc)
  /// ISO 639-2
  iso6392            String? @db.Char(3)
  /// Language name in it's language.
  nativeName         String
  /// Is this language being actively used for translations?
  activelyTranslated Boolean @default(false)

  // fields using records
  AttributeSupplement AttributeSupplement[]
  OrgReview           OrgReview[]
  User                User[]
  OrgPhone            OrgPhone[]
  OrgWebsite          OrgWebsite[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

//
// Translation tables for database values.
//

// Top level category for i18next
model TranslationNamespace {
  id String @id @default(cuid()) /// @zod.custom(imports.cuid)

  name String @unique

  keys TranslationKey[]

  attributeCategory AttributeCategory[]

  exportFile Boolean @default(true)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  // needed to have 'ns' field on TranslationKey
  @@unique([id, name])
}

// Item key - i18next
model TranslationKey {
  id          String               @id @default(cuid()) /// @zod.custom(imports.cuid)
  /// Item key
  key         String
  /// Base string
  text        String
  /// Context
  context     String?
  /// Associated namespace
  namespace   TranslationNamespace @relation(fields: [namespaceId, ns], references: [id, name])
  namespaceId String /// @zod.custom(imports.cuid)
  ns          String
  // to manage plurals & ordinals
  parent      TranslationKey?      @relation("translationSubItems", fields: [parentId], references: [id])
  parentId    String? /// @zod.custom(imports.cuid)
  children    TranslationKey[]     @relation("translationSubItems")

  /// Associated tables
  attribute           Attribute?
  attributeSupplement AttributeSupplement[]
  country             Country?              @relation("country")
  demonym             Country?              @relation("demonym")
  footerLink          FooterLink?
  govDist             GovDist[]
  govDistType         GovDistType?
  navigation          Navigation?
  organization        Organization[]
  orgServiceAccess    OrgService?           @relation("Service Access Instructions")
  orgServiceDesc      OrgService?           @relation("Service Description")
  orgWebsite          OrgWebsite[]
  phoneType           PhoneType?
  serviceCategory     ServiceCategory?
  serviceTag          ServiceTag?
  socialMediaService  SocialMediaService?
  userCommunity       UserCommunity?
  userEthnicity       UserEthnicity?
  userImmigration     UserImmigration?
  userSOGIdentity     UserSOGIdentity?
  userTitle           UserTitle?
  userType            UserType?

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  /// Only 1 key per namespace
  @@unique([ns(sort: Asc), key(sort: Asc)])
}

/// Define outside APIs in use
model OutsideAPI {
  id          String @id @default(cuid()) /// @zod.custom(imports.cuid)
  name        String @unique
  description String

  urlPattern String

  Organization Organization[]
  OrgLocation  OrgLocation[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Visibilty settings for user profile pages
model FieldVisibility {
  id     String @id @default(cuid()) /// @zod.custom(imports.cuid)
  user   User   @relation(fields: [userId], references: [id])
  userId String /// @zod.custom(imports.cuid)

  firstName      VisibilitySetting @default(NONE)
  lastName       VisibilitySetting @default(NONE)
  lastNameInit   VisibilitySetting @default(NONE)
  email          VisibilitySetting @default(NONE)
  image          VisibilitySetting @default(NONE)
  ethnicity      VisibilitySetting @default(NONE)
  countryOrigin  VisibilitySetting @default(NONE)
  SOG            VisibilitySetting @default(NONE)
  communities    VisibilitySetting @default(NONE)
  currentCity    VisibilitySetting @default(NONE)
  currentGovDist VisibilitySetting @default(NONE)
  currentCountry VisibilitySetting @default(NONE)
  userType       VisibilitySetting @default(NONE) /// for specialized accounts
  associatedOrg  VisibilitySetting @default(NONE)
  orgTitle       VisibilitySetting @default(NONE)
  createdAt      VisibilitySetting @default(NONE) /// to facilitate "User since..."

  recordCreatedAt DateTime @default(now())
  recordupdatedAt DateTime @updatedAt

  auditLog AuditLog[]
}

enum VisibilitySetting {
  NONE
  LOGGED_IN
  PROVIDER
  PUBLIC
}

/// Define the App navigation tree
///  this will be used to generate a json file at build time
model Navigation {
  id       String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  display  String
  href     String?
  isParent Boolean @default(true)
  icon     String?

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  parentItem Navigation?  @relation(name: "navHeirarchy", fields: [parentId], references: [id])
  parentId   String? /// @zod.custom(imports.cuid)
  children   Navigation[] @relation("navHeirarchy")

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@unique([display, href])
}

model FooterLink {
  id      String  @id @default(cuid()) /// @zod.custom(imports.cuid)
  display String
  href    String
  icon    String?

  key   TranslationKey @relation(fields: [keyId], references: [id])
  keyId String         @unique /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]

  @@unique([display, href])
}

model SocialMediaLink {
  id   String @id @default(cuid()) /// @zod.custom(imports.cuid)
  href String @unique
  icon String

  service   SocialMediaService @relation(fields: [serviceId], references: [id])
  serviceId String /// @zod.custom(imports.cuid)

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  auditLog     AuditLog[]
  internalNote InternalNote[]
}

/// Internal notes - multipurpose
model InternalNote {
  id   String @id @default(cuid()) /// @zod.custom(imports.cuid)
  text String

  attribute              Attribute?            @relation(fields: [attributeId], references: [id])
  attributeId            String? /// @zod.custom(imports.cuid)
  attributeCategory      AttributeCategory?    @relation(fields: [attributeCategoryId], references: [id])
  attributeCategoryId    String? /// @zod.custom(imports.cuid)
  attributeSupplement    AttributeSupplement?  @relation(fields: [attributeSupplementId], references: [id])
  attributeSupplementId  String? /// @zod.custom(imports.cuid)
  country                Country?              @relation(fields: [countryId], references: [id])
  countryId              String? /// @zod.custom(imports.cuid)
  footerLink             FooterLink?           @relation(fields: [footerLinkId], references: [id])
  footerLinkId           String? /// @zod.custom(imports.cuid)
  govDist                GovDist?              @relation(fields: [govDistId], references: [id])
  govDistId              String? /// @zod.custom(imports.cuid)
  govDistType            GovDistType?          @relation(fields: [govDistTypeId], references: [id])
  govDistTypeId          String? /// @zod.custom(imports.cuid)
  language               Language?             @relation(fields: [languageId], references: [id])
  languageId             String? /// @zod.custom(imports.cuid)
  navigation             Navigation?           @relation(fields: [navigationId], references: [id])
  navigationId           String? /// @zod.custom(imports.cuid)
  organization           Organization?         @relation(fields: [organizationId], references: [id])
  organizationId         String? /// @zod.custom(imports.cuid)
  orgEmail               OrgEmail?             @relation(fields: [orgEmailId], references: [id])
  orgEmailId             String? /// @zod.custom(imports.cuid)
  orgHours               OrgHours?             @relation(fields: [orgHoursId], references: [id])
  orgHoursId             String? /// @zod.custom(imports.cuid)
  orgLocation            OrgLocation?          @relation(fields: [orgLocationId], references: [id])
  orgLocationId          String? /// @zod.custom(imports.cuid)
  orgPhone               OrgPhone?             @relation(fields: [orgPhoneId], references: [id])
  orgPhoneId             String? /// @zod.custom(imports.cuid)
  orgPhoto               OrgPhoto?             @relation(fields: [orgPhotoId], references: [id])
  orgPhotoId             String? /// @zod.custom(imports.cuid)
  orgReview              OrgReview?            @relation(fields: [orgReviewId], references: [id])
  orgReviewId            String? /// @zod.custom(imports.cuid)
  orgService             OrgService?           @relation(fields: [orgServiceId], references: [id])
  orgServiceId           String? /// @zod.custom(imports.cuid)
  orgSocialMedia         OrgSocialMedia?       @relation(fields: [orgSocialMediaId], references: [id])
  orgSocialMediaId       String? /// @zod.custom(imports.cuid)
  outsideApi             OutsideAPI?           @relation(fields: [outsideApiId], references: [id])
  outsideApiId           String? /// @zod.custom(imports.cuid)
  phoneType              PhoneType?            @relation(fields: [phoneTypeId], references: [id])
  phoneTypeId            String? /// @zod.custom(imports.cuid)
  serviceArea            ServiceArea?          @relation(fields: [serviceAreaId], references: [id])
  serviceAreaId          String? /// @zod.custom(imports.cuid)
  serviceCategory        ServiceCategory?      @relation(fields: [serviceCategoryId], references: [id])
  serviceCategoryId      String? /// @zod.custom(imports.cuid)
  serviceTag             ServiceTag?           @relation(fields: [serviceTagId], references: [id])
  serviceTagId           String? /// @zod.custom(imports.cuid)
  socialMediaLink        SocialMediaLink?      @relation(fields: [socialMediaLinkId], references: [id])
  socialMediaLinkId      String? /// @zod.custom(imports.cuid)
  socialMediaService     SocialMediaService?   @relation(fields: [socialMediaServiceId], references: [id])
  socialMediaServiceId   String? /// @zod.custom(imports.cuid)
  source                 Source?               @relation(fields: [sourceId], references: [id])
  sourceId               String? /// @zod.custom(imports.cuid)
  translationKey         TranslationKey?       @relation(fields: [translationKeyId], references: [id])
  translationKeyId       String? /// @zod.custom(imports.cuid)
  translationNamespace   TranslationNamespace? @relation(fields: [translationNamespaceId], references: [id])
  translationNamespaceId String? /// @zod.custom(imports.cuid)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLog     AuditLog[]
  OrgWebsite   OrgWebsite? @relation(fields: [orgWebsiteId], references: [id])
  orgWebsiteId String?
}

/// Store changes made by users
model AuditLog {
  id        String   @id @default(cuid()) /// @zod.custom(imports.cuid)
  actor     User     @relation("Recorded User", fields: [actorId], references: [id])
  actorId   String /// @zod.custom(imports.cuid)
  timestamp DateTime @default(now())

  from Json
  to   Json

  table    String
  recordId String

  Account                Account?              @relation(fields: [accountId], references: [id])
  accountId              String? /// @zod.custom(imports.cuid)
  Attribute              Attribute?            @relation(fields: [attributeId], references: [id])
  attributeId            String? /// @zod.custom(imports.cuid)
  AttributeCategory      AttributeCategory?    @relation(fields: [attributeCategoryId], references: [id])
  attributeCategoryId    String? /// @zod.custom(imports.cuid)
  AttributeSupplement    AttributeSupplement?  @relation(fields: [attributeSupplementId], references: [id])
  attributeSupplementId  String? /// @zod.custom(imports.cuid)
  Country                Country?              @relation(fields: [countryId], references: [id])
  countryId              String? /// @zod.custom(imports.cuid)
  FieldVisibility        FieldVisibility?      @relation(fields: [fieldVisibilityId], references: [id])
  fieldVisibilityId      String? /// @zod.custom(imports.cuid)
  FooterLink             FooterLink?           @relation(fields: [footerLinkId], references: [id])
  footerLinkId           String? /// @zod.custom(imports.cuid)
  GovDist                GovDist?              @relation(fields: [govDistId], references: [id])
  govDistId              String? /// @zod.custom(imports.cuid)
  GovDistType            GovDistType?          @relation(fields: [govDistTypeId], references: [id])
  govDistTypeId          String? /// @zod.custom(imports.cuid)
  InternalNote           InternalNote?         @relation(fields: [internalNoteId], references: [id])
  internalNoteId         String? /// @zod.custom(imports.cuid)
  Language               Language?             @relation(fields: [languageId], references: [id])
  languageId             String? /// @zod.custom(imports.cuid)
  Navigation             Navigation?           @relation(fields: [navigationId], references: [id])
  navigationId           String? /// @zod.custom(imports.cuid)
  Organization           Organization?         @relation(fields: [organizationId], references: [id])
  organizationId         String? /// @zod.custom(imports.cuid)
  OrgEmail               OrgEmail?             @relation(fields: [orgEmailId], references: [id])
  orgEmailId             String? /// @zod.custom(imports.cuid)
  OrgHours               OrgHours?             @relation(fields: [orgHoursId], references: [id])
  orgHoursId             String? /// @zod.custom(imports.cuid)
  OrgLocation            OrgLocation?          @relation(fields: [orgLocationId], references: [id])
  orgLocationId          String? /// @zod.custom(imports.cuid)
  OrgPhone               OrgPhone?             @relation(fields: [orgPhoneId], references: [id])
  orgPhoneId             String? /// @zod.custom(imports.cuid)
  OrgPhoto               OrgPhoto?             @relation(fields: [orgPhotoId], references: [id])
  orgPhotoId             String? /// @zod.custom(imports.cuid)
  OrgReview              OrgReview?            @relation(fields: [orgReviewId], references: [id])
  orgReviewId            String? /// @zod.custom(imports.cuid)
  OrgService             OrgService?           @relation(fields: [orgServiceId], references: [id])
  orgServiceId           String? /// @zod.custom(imports.cuid)
  OrgSocialMedia         OrgSocialMedia?       @relation(fields: [orgSocialMediaId], references: [id])
  orgSocialMediaId       String? /// @zod.custom(imports.cuid)
  OutsideAPI             OutsideAPI?           @relation(fields: [outsideAPIId], references: [id])
  outsideAPIId           String? /// @zod.custom(imports.cuid)
  PermissionAsset        PermissionAsset?      @relation(fields: [permissionAssetId], references: [id])
  permissionAssetId      String? /// @zod.custom(imports.cuid)
  PermissionItem         PermissionItem?       @relation(fields: [permissionItemId], references: [id])
  permissionItemId       String? /// @zod.custom(imports.cuid)
  PhoneType              PhoneType?            @relation(fields: [phoneTypeId], references: [id])
  phoneTypeId            String? /// @zod.custom(imports.cuid)
  ServiceArea            ServiceArea?          @relation(fields: [serviceAreaId], references: [id])
  serviceAreaId          String? /// @zod.custom(imports.cuid)
  ServiceCategory        ServiceCategory?      @relation(fields: [serviceCategoryId], references: [id])
  serviceCategoryId      String? /// @zod.custom(imports.cuid)
  ServiceTag             ServiceTag?           @relation(fields: [serviceTagId], references: [id])
  serviceTagId           String? /// @zod.custom(imports.cuid)
  SocialMediaLink        SocialMediaLink?      @relation(fields: [socialMediaLinkId], references: [id])
  socialMediaLinkId      String? /// @zod.custom(imports.cuid)
  SocialMediaService     SocialMediaService?   @relation(fields: [socialMediaServiceId], references: [id])
  socialMediaServiceId   String? /// @zod.custom(imports.cuid)
  Source                 Source?               @relation(fields: [sourceId], references: [id])
  sourceId               String? /// @zod.custom(imports.cuid)
  TranslationKey         TranslationKey?       @relation(fields: [translationKeyId], references: [id])
  translationKeyId       String? /// @zod.custom(imports.cuid)
  TranslationNamespace   TranslationNamespace? @relation(fields: [translationNamespaceId], references: [id])
  translationNamespaceId String? /// @zod.custom(imports.cuid)
  User                   User[]                @relation("AuditLogEntry") //@relation("AuditLogEntry", fields: [userId], references: [id])
  userId                 String? /// @zod.custom(imports.cuid)
  UserCommunity          UserCommunity?        @relation(fields: [userCommunityId], references: [id])
  userCommunityId        String? /// @zod.custom(imports.cuid)
  UserEthnicity          UserEthnicity?        @relation(fields: [userEthnicityId], references: [id])
  userEthnicityId        String? /// @zod.custom(imports.cuid)
  UserImmigration        UserImmigration?      @relation(fields: [userImmigrationId], references: [id])
  userImmigrationId      String? /// @zod.custom(imports.cuid)
  UserMail               UserMail?             @relation(fields: [userMailId], references: [id])
  userMailId             String? /// @zod.custom(imports.cuid)
  UserRole               UserRole?             @relation(fields: [userRoleId], references: [id])
  userRoleId             String? /// @zod.custom(imports.cuid)
  UserSavedList          UserSavedList?        @relation(fields: [userSavedListId], references: [id])
  userSavedListId        String? /// @zod.custom(imports.cuid)
  UserSOGIdentity        UserSOGIdentity?      @relation(fields: [userSOGIdentityId], references: [id])
  userSOGIdentityId      String? /// @zod.custom(imports.cuid)
  UserTitle              UserTitle?            @relation(fields: [userTitleId], references: [id])
  userTitleId            String? /// @zod.custom(imports.cuid)
  UserType               UserType?             @relation(fields: [userTypeId], references: [id])
  userTypeId             String? /// @zod.custom(imports.cuid)
  OrgWebsite             OrgWebsite?           @relation(fields: [orgWebsiteId], references: [id])
  orgWebsiteId           String?

  @@unique([timestamp, recordId])
}
