SELECT
  attr."name" AS "Attribute",
  COUNT(DISTINCT CASE WHEN c."id" = 'ctry_01GW2HHDK9M26M80SG63T21SVH' THEN os."id" END) AS "United States",
  COUNT(DISTINCT CASE WHEN c."id" = 'ctry_01GW2HHDKAWXWYHAAESAA5HH94' THEN os."id" END) AS "Canada",
  COUNT(DISTINCT CASE WHEN c."id" = 'ctry_01GW2HHDKB9DG2T2YZM5MFFVX9' THEN os."id" END) AS "Mexico",
  COUNT(DISTINCT CASE WHEN c."id" NOT IN (
    'ctry_01GW2HHDK9M26M80SG63T21SVH',
    'ctry_01GW2HHDKAWXWYHAAESAA5HH94',
    'ctry_01GW2HHDKB9DG2T2YZM5MFFVX9'
  ) THEN os."id" END) AS "Other"
FROM public."Attribute" attr
LEFT JOIN public."AttributeSupplement" a ON a."attributeId" = attr."id"
LEFT JOIN public."OrgService" os ON a."serviceId" = os."id" AND os."published" IS TRUE
LEFT JOIN public."OrgLocationService" ols ON os."id" = ols."serviceId"
LEFT JOIN public."OrgLocation" ol ON ols."orgLocationId" = ol."id"
LEFT JOIN public."Country" c ON ol."countryId" = c."id"
WHERE attr."id" IN (
  'attr_01GW2HHFVN72D7XEBZZJXCJQXQ',
  'attr_01GW2HHFVPCVX8F3B7M30ZJEHW',
  'attr_01GW2HHFVPJERY0GS9D7F56A23',
  'attr_01GW2HHFVPSYBCYF37B44WP6CZ',
  'attr_01GW2HHFVPTK9555WHJHDBDA2J',
  'attr_01GW2HHFVQ7SYGD3KM8WP9X50B',
  'attr_01GW2HHFVQ8AGBKBBZJWTHNP2F',
  'attr_01GW2HHFVQCZPA3Z5GW6J3MQHW',
  'attr_01GW2HHFVQEFWW42MBAD64BWXZ',
  'attr_01GW2HHFVQVEGH6W3A2ANH1QZE',
  'attr_01GW2HHFVQX4M8DY1FSAYSJSSK',
  'attr_01GW2HHFVRMQFJ9AMA633SQQGV',
  'attr_01H273DMQ22TVP3RA36M1XWFBA',
  'attr_01H273ETEX43K0BR6FG3G7MZ4S',
  'attr_01H273FCJ8NNG1T1BV300CN702',
  'attr_01H273FPTCFKTVBNK158HE9M42',
  'attr_01H273G39A14TGHT4DA1T0DW5M'
)
GROUP BY attr."name"
ORDER BY attr."name";
